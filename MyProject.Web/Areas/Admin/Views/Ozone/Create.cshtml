
@model MyProject.Data.Ozone


@{
	ViewBag.Title = "Create";
	Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
<style>
	.video-frame {
		width: 100%;
		height: auto;
		box-shadow: 0 0.5rem 1.5rem 0.5rem rgb(0 0 0 / 8%);
		border-radius: 5px;
		padding: 10px;
	}

	.introduction-video {
		width: auto;
		height: 300px;
		margin-left: auto;
		margin-right: auto;
		display: block;
	}

	.image-input .image-input-wrapper {
		width: 800px;
		height: 300px;
	}
</style>
<!--begin::Content-->
<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
	<!--begin::Subheader-->
	<div class="subheader py-2 py-lg-12 subheader-transparent" id="kt_subheader">
		<div class="container d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
			<!--begin::Info-->
			<div class="d-flex align-items-center flex-wrap mr-1">
				<!--begin::Heading-->
				<div class="d-flex flex-column">

					<!--begin::Breadcrumb-->
					<div class="d-flex align-items-center font-weight-bold my-2">
						<!--begin::Item-->
						<a href="/Admin/Dashboard/Index" class="opacity-75 hover-opacity-100">
							<i class="flaticon2-shelter text-white icon-1x"></i>
						</a>
						<!--end::Item-->
						<!--begin::Item-->
						<a href="/Admin/Dashboard/Index" class="text-white text-hover-white opacity-75 hover-opacity-100">&nbsp;&nbsp;Dashboard</a>
						<!--end::Item-->
						<!--begin::Item-->
						<span class="label label-dot label-sm bg-white opacity-75 mx-3"></span>
						<a href="javascript:;" class="text-white text-hover-white opacity-75 hover-opacity-100">Ozone</a>

						<!--end::Item-->
					</div>
					<!--end::Breadcrumb-->
				</div>
				<!--end::Heading-->
			</div>
			<!--end::Info-->
		</div>
	</div>
	<!--end::Subheader-->
	<!--begin::Entry-->
	<div class="d-flex flex-column-fluid">
		<!--begin::Container-->
		<div class="container">
			<!--begin::Dashboard-->
			<!--begin::Card-->
			<div class="card card-custom" id="kt_page_sticky_card">
				<div class="card-header">
					<div class="card-title">
						<h3 class="card-label">
							Ozone 
							<span class="d-block text-muted pt-2 font-size-sm">Update Ozone Here...</span>
						</h3>
					</div>
					<div class="card-toolbar">
						@if (Model.ID != null)
						{
                        <a href="/Admin/OzoneImage/CreateOzoneGallery/@Model.ID" class="btn btn-light-primary font-weight-bolder mr-2">
                            <i class="fas fa-image"></i> Ozone Gallery
                        </a>
						}
						<a href="/Admin/Dashboard/Index" class="btn btn-light-primary font-weight-bolder mr-2">
							<i class="ki ki-long-arrow-back icon-sm"></i>Back
						</a>
						<div class="btn-group">
							<button type="submit" class="btn btn-custom font-weight-bolder" form="Userform">
								<i class="ki ki-check icon-sm"></i>Save
							</button>
						</div>
					</div>

				</div>
				<div class="card-body">
					@using (Html.BeginForm("Create", "Ozone", new { area = "Admin", id = (Model != null ? Model.ID : 0) }, FormMethod.Post, new { enctype = "multipart/form-data", id = "Userform" }))
					{
						@Html.AntiForgeryToken()
						<div class="alert alert-danger text-center" id="divMessage" style="display:none"></div>
						@Html.ValidationSummary(true, "", new { @class = "text-danger" })
						<div class="form-group row">
							<div class="col-lg-12 text-center">
								<h4>OZONE Main Image</h4>
								<div class="image-input image-input-outline" id="kt_image_1">
									<div class="h-200px h-md-400px image-input-wrapper w-200px w-lg-800px w-md-400px" style="background-image: url('@Model.Thumbnail');background-size: contain;
    background-position: center;"></div>
									<label class="btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow" data-action="change" data-toggle="tooltip" title="" data-original-title="Change thumbnail">
										<i class="fa fa-pen icon-sm text-muted"></i>
										<input type="file" name="thumbnailFile" id="thumbnailFile" accept=".png, .jpg, .jpeg" />
										<input type="hidden" hidden name="Thumbnail" id="thumbnail" value="@Model.Thumbnail" />
										<input type="hidden" name="profile_avatar_remove" />
									</label>
									<span class="btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow cancelimage" data-action="cancel" data-toggle="tooltip" title="Cancel avatar">
										<i class="ki ki-bold-close icon-xs text-muted"></i>
									</span>
								</div>
								@*<span class="form-text text-muted">Image dimensions should be 1450 x 816 pixels and Image size must be less than 300 kb</span>*@
							</div>
						</div>
						<div class="row">




							@*<div class="col-md-6 col-sm-12">
									<div class="form-group">
										<label class="control-label">Description</label>
										<div class="input-group mb-2">
											@Html.TextAreaFor(model => model.Description, 10, 30, new { @class = "form-control", placeholder = "Enter description  here ..." ,@required="required"})

										</div>
										@Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger" })
									</div>
								</div>
								<div class="col-md-6 col-sm-12">
									<div class="form-group">
										<label class="control-label">Description(Ar)</label>
										<div class="input-group mb-3">
											@Html.TextAreaFor(model => model.DescriptionAr, 10, 30, new { @class = "form-control", placeholder = "Enter description(Ar)  here ...", dir = "rtl", @required = "required" })

										</div>
										@Html.ValidationMessageFor(model => model.DescriptionAr, "", new { @class = "text-danger" })
									</div>
								</div>*@

							<div id="video" class="col-md-12 col-sm-12">
								<div class="form-group">
									<label class="control-label">Video</label>
									<div class="input-group mb-2">
										@Html.TextBox("VideoFile", "", new { type = "file", name = "VideoFile", @class = "form-control" })

										<div class="input-group-append">
											<span class="input-group-text"><i class="fa fa-video"></i></span>
										</div>
									</div>
								</div>
							</div>
						</div>
						<br />
						<div class="row justify-content-center">
							<div class="col-md-8 col-sm-12">
								@if (!string.IsNullOrEmpty(Model.Video))
								{
									<h4 style="text-align:center">Ozone Video</h4>
									<div class="video-frame">
										<span class="btn btn-circle btn-hover-text-primary btn-icon btn-white btn-pill btn-shadow btn-xs float-right mb-2" data-action="cancel" id="deletevideo" data-toggle="tooltip" title="Delete Video">
											<i class="ki ki-bold-close icon-xs text-muted"></i>
										</span>
										<video style="width: 100%; height: 100%;" controls>
											<source src="@Url.Content(Model.Video)" type="video/mp4" />
										</video>
									</div>
									<input type="hidden" name="Video" value="@Model.Video">
								}
							</div>
						</div>

					}
				</div>
			</div>
			<!--end::Card-->
			<!--end::Dashboard-->
		</div>
		<!--end::Container-->
	</div>
	<!--end::Entry-->
</div>


<div id="myModal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
	<div class="modal-dialog modal-dialog-centered modal-xl" role="document">
		<div class="modal-content" style="min-height:100px">
			<div id='myModalContent'>
				<div class="row justify-content-center">
					<div class="col-12">
						<div class="kt-spinner kt-spinner--lg kt-spinner--dark kt-spinner-modal"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!--end::Row-->
<script>
	var SuccessMessage = '@ViewBag.SuccessMessage';
	var ErrorMessage = '@ViewBag.ErrorMessage';
</script>



@section IndexScript {
	<script src="~/Assets/Admin/js/general/ModalPopup.js"></script>
	<!--end::Page Scripts-->

	<script>
		'use strict';

		// Class definition
		var KTImageInputDemo = function () {
			// Private functions
			var initDemos = function () {
				var avatar1 = new KTImageInput('kt_image_1');
			}

			return {
				// public functions
				init: function () {
					initDemos();
				}
			};
		}();

        var _URL = window.URL || window.webkitURL;
        //Image Validation Begin
		$("#thumbnailFile").change(function (e) {


            var file, img;

            if ((file = this.files[0])) {

                img = new Image();
                img.onload = function () {

					//if (this.width < 1450 || this.width > 1450) {
     //                   Swal.fire({
     //                       icon: 'error',
     //                       title: 'Oops...',
					//		text: 'Image dimension should be 1450 x 816 !',

     //                   }).then(function (result) {
					//		$("#thumbnailFile").attr("src", "/Assets/AppFiles/Images/default.png");
     //                       $(".cancelimage").trigger('click');
     //                   });
     //               }
					//else if (this.height < 816 || this.height > 816) {
     //                   Swal.fire({
     //                       icon: 'error',
     //                       title: 'Oops...',
					//		text: 'Image dimension should be 1450 x 816 !',

     //                   }).then(function (result) {
					//		$("#thumbnailFile").attr("src", "/Assets/AppFiles/Images/default.png");
     //                       $(".cancelimage").trigger('click');
     //                   });
     //               }
					//else
					if (file.size > 300000) {
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'Image size must be less than 300 kb!',

                        }).then(function (result) {
							$("#thumbnailFile").attr("src", "/Assets/AppFiles/Images/default.png");
                            $(".cancelimage").triggeModel('click');
                        });
                    }
                    else {
                        img.onerror = function () {
                            alert("not a valid file: " + file.type);
                        };
                    }
                };
                img.src = _URL.createObjectURL(file);
            }
        });
		//Image Validation End


		KTUtil.ready(function () {

			var str = '@Model.Video';
			str = str.toString();
			if (str == "") {
				$("#video").show();
			}
			else if (str != null) {
				$("#video").hide();
			}
			else {
				$("#video").show();
			}
			KTImageInputDemo.init();


		});

		$("#deletevideo").click(function () {
			$(".video-frame").hide();
			$("#video").show();

			$("input[name=Video][type=hidden]").remove();
		})

        $("#Video").change(function (e) {

            var file;

            if ((file = this.files[0])) {

                if (!file.type.match('video.*')) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'Please upload valid video file !',

                    }).then(function (result) {
                        $("#Video").val("");
                    });
                }
                else if (file.size >= 4194304) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'Video size must be less than 4 mb !',

                    }).then(function (result) {
                        $("#Video").val("");
                    });
                }
            }
        });

		if (SuccessMessage) {
			toastr.success(SuccessMessage);
		}
		else if (ErrorMessage) {
			toastr.error(ErrorMessage);
		}
	</script>
	<!--end::Page Scripts-->
}

